#include <esp_now.h>
#include <WiFi.h>

// MAC Address of Board A (Receiver)
uint8_t broadcastAddress[] = {0xEC, 0xE3, 0x34, 0x1A, 0xF6, 0x14};

typedef struct struct_message {
    int count;
} struct_message;

struct_message myData;
esp_now_peer_info_t peerInfo;
int timer = 0;

void setup() {
  Serial.begin(115200);
  WiFi.mode(WIFI_STA);

  if (esp_now_init() != ESP_OK) return;

  memcpy(peerInfo.peer_addr, broadcastAddress, 6);
  peerInfo.channel = 0;  
  peerInfo.encrypt = false;
  
  if (esp_now_add_peer(&peerInfo) != ESP_OK) return;
}

void loop() {
  timer++;
  myData.count = timer;

  esp_now_send(broadcastAddress, (uint8_t *) &myData, sizeof(myData));
  
  Serial.print("Sending: ");
  Serial.println(timer);
  
  delay(1000); // Update once per second
}
